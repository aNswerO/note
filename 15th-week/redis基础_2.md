# redis持久化：
>redis使用内存进行数据缓存，但其可以将内存中的数据按照一定的策略保存在硬盘上，从而实现数据的持久保存；redis支持两种不同方式的数据持久化保存机制，分别是RDB和AOF
## RDB模式：
>基于时间的快照，只保留当前最新的一次快照
+ RDB的实现过程：
    ```
        redis从主进程先fork出一个子进程，利用写时复制机制，子进程将内存中的数据保存为一个临时文件，当数据保存完成后再将上一次保存的RDB文件替换掉，之后再关闭这个子进程
    ```

+ 优点：
    + RDB快照保存了某个时间点的数据，可以通过脚本执行bgsave（非阻塞）或save（阻塞）命令自定义时间点来备份，可以保留多个备份，出现问题时可以恢复到不同时间点的版本

    + 最大化IO性能，因为父进程在保存RDB文件时唯一要做的事就是fork一个子进程，接下来的操作都交给这个子进程完成，父进程无需进行任何IO操作
    + 恢复速度快（相比于AOF）
+ 缺点：
    + 无法时时保存数据，会丢失自上一次执行RDB备份到当前的内存数据

## AOF模式：
>按照操作顺序依次将操作添加到指定的日志文件中（类似于mysql的二进制日志）
+ AOF的实现过程：
    ```
        AOF也使用了写时复制机制，AOF默认为每秒fsync一次，即每秒将执行的命令保存到AOF文件中，也可以设置不同的fsync策略；fsync会在后台执行线程，所以主线程可以继续处理用户请求，而不会收到写入AOF文件的IO影响
    ```
+ 优点：
    + 按需改变fsync策略可以灵活地进行备份

+ 缺点：
    + AOF文件的大小要大于RDB文件
# redis常用命令：
+ CONFIG：
    >config命令用于查看当前redis配置，也可以不重启更改配置（临时生效，仅针对此次开启进程，重启redis会重置，想永久生效还是要修改配置文件）
    + 更改最大内存：
        ```
        config set maxmemory 8589934592
        ```
    + 设置连接密码：
        ```
        config set requirepass centos
        ```
    + 查看当前所有配置：
        ```sh
        config get *
        #奇数行为配置的项，偶数行为上一行配置项的值
        ```

+ info：
    >显示当前节点的redis的运行状态信息
    ```
    info
    ```
+ select：
    >切换数据库
    ```sh
    select 1
    #通过select数据库的索引来切换数据库，索引的取值范围为“0 ~ （配置项database指定的值-1）”
    ```
+ keys：
    >查看当前库下的所有key
    ```
    keys *
    ```
+ bgsave:
    >手动在后台执行RDB持久化操作（非阻塞）
    ```
    bgsave
    ```
+ dbsize：
    >返回当前库下的所有key的数量
    ```
    dbsize
    ```
+ flushdb：
    >强制清空当前库中的所有key
    ```
    flushdb
    ```
+ flushall：
    >强制清空当前redis服务器所有数据库中的所有key，即删除所有数据
    ```
    flushall
    ```
